knitr::opts_chunk$set(echo = TRUE)
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read.csv(nypd_url)
nypd_csv
nypd_data <- nypd_csv %>%
select( -c(`OCCUR_DATE`, `OCCUR_TIME`, PERP_AGE_GROUP, PERP_SEX, PERP_RACE, VIC_AGE_GROUP, VIC_SEX, VIC_RACE, Lon_Lat))
nypd_data <- select( -c(`OCCUR_DATE`, `OCCUR_TIME`, PERP_AGE_GROUP, PERP_SEX, PERP_RACE, VIC_AGE_GROUP, VIC_SEX, VIC_RACE, Lon_Lat))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read.csv(nypd_url)
nypd_data <- nypd_csv-c(`OCCUR_DATE`, `OCCUR_TIME`, PERP_AGE_GROUP, PERP_SEX, PERP_RACE, VIC_AGE_GROUP, VIC_SEX, VIC_RACE, Lon_Lat)
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read.csv(nypd_url, c(`OCCUR_DATE`, `OCCUR_TIME`, PERP_AGE_GROUP, PERP_SEX, PERP_RACE, VIC_AGE_GROUP, VIC_SEX, VIC_RACE, Lon_Lat))
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read.csv(nypd_url, c("OCCUR_DATE", "OCCUR_TIME", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat"))
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read_csv(nypd_url, c("OCCUR_DATE", "OCCUR_TIME", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat"))
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read_csv(nypd_url)
cols = c("OCCUR_DATE", "OCCUR_TIME", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat")
npyd_csv
nypd_csv
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read_csv(nypd_url, col_select = c("OCCUR_DATE", "OCCUR_TIME", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat"))
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read_csv(nypd_url, col_select = c("OCCUR_DATE", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat"))
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read_csv(nypd_url, col_select = c("OCCUR_DATE", "OCCUR_TIME", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat"))
nypd_csv
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
formattedCSV <- nypd_csv %>%
mutate(date_occur = mdy(OCCUR_DATE))
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %<% filter(PERP_AGE_GROUP != "")
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP != "")
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP == "")
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP = "")
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP == "")
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP == NA)
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP != NA)
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV <- formattedCSV %>% filter(PERP_AGE_GROUP != "")
formattedCSV
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
nypd_url  <- "https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD"
nypd_csv <- read_csv(nypd_url, col_select = c("OCCUR_DATE", "OCCUR_TIME", "PERP_AGE_GROUP", "PERP_SEX", "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE", "Lon_Lat"), na = c("UNKNOWN"))
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
summary(formattedCSV)
formattedCSV
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE))
formattedCSV[formattedCSV==""] <- "UNKNOWN"
summary(formattedCSV)
formattedCSV
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
nypd_csv[nypd_csv==""] <- "UNKNOWN"
nypd_csv[is.na(nypd_csv)] <- "UNKNOWN"
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE), OCCUR_TIME = hms(OCCUR_TIME)) %>%
mutate(P_AGE_GROUP = recode(PERP_AGE_GROUP,"<18" = 1,"18-24" = 2, "25-44" = 3, "45-64" = 4, "65+" = 5, .default = -1)) %>%
mutate(V_AGE_GROUP = recode(VIC_AGE_GROUP,"<18" = 1,"18-24" = 2, "25-44" = 3, "45-64" = 4, "65+" = 5, .default = -1)) %>%
mutate(MONTH = month(OCCUR_DATE))
filteredCSV <- filter(formattedCSV, V_AGE_GROUP > 0)
filteredCSV <- filter(filteredCSV, P_AGE_GROUP > 0)
filteredCSV <- filter(filteredCSV, PERP_SEX %in% c("M", "F"))
filteredCSV <- filter(filteredCSV, VIC_SEX %in% c("M", "F"))
filteredCSV["Perp_vs_Vic"] <- filteredCSV %>% case_when(
P_AGE_GROUP < filteredCSV["V_AGE_GROUP"] ~ "LESS",
filteredCSV["P_AGE_GROUP"] > filteredCSV["V_AGE_GROUP"] ~ "GREATER",
filteredCSV["P_AGE_GROUP"] %% filteredCSV["V_AGE_GROUP"] == 0 ~ "SAME",
)
nypd_csv[nypd_csv==""] <- "UNKNOWN"
nypd_csv[is.na(nypd_csv)] <- "UNKNOWN"
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE), OCCUR_TIME = hms(OCCUR_TIME)) %>%
mutate(P_AGE_GROUP = recode(PERP_AGE_GROUP,"<18" = 1,"18-24" = 2, "25-44" = 3, "45-64" = 4, "65+" = 5, .default = -1)) %>%
mutate(V_AGE_GROUP = recode(VIC_AGE_GROUP,"<18" = 1,"18-24" = 2, "25-44" = 3, "45-64" = 4, "65+" = 5, .default = -1)) %>%
mutate(MONTH = month(OCCUR_DATE))
filteredCSV <- filter(formattedCSV, V_AGE_GROUP > 0)
filteredCSV <- filter(filteredCSV, P_AGE_GROUP > 0)
filteredCSV <- filter(filteredCSV, PERP_SEX %in% c("M", "F"))
filteredCSV <- filter(filteredCSV, VIC_SEX %in% c("M", "F"))
filteredCSV["Perp_vs_Vic"] <- filteredCSV %>% case_when(
P_AGE_GROUP < V_AGE_GROUP ~ "LESS",
filteredCSV["P_AGE_GROUP"] > filteredCSV["V_AGE_GROUP"] ~ "GREATER",
filteredCSV["P_AGE_GROUP"] %% filteredCSV["V_AGE_GROUP"] == 0 ~ "SAME",
)
nypd_csv[nypd_csv==""] <- "UNKNOWN"
nypd_csv[is.na(nypd_csv)] <- "UNKNOWN"
formattedCSV <- nypd_csv %>%
mutate(OCCUR_DATE = mdy(OCCUR_DATE), OCCUR_TIME = hms(OCCUR_TIME)) %>%
mutate(P_AGE_GROUP = recode(PERP_AGE_GROUP,"<18" = 1,"18-24" = 2, "25-44" = 3, "45-64" = 4, "65+" = 5, .default = -1)) %>%
mutate(V_AGE_GROUP = recode(VIC_AGE_GROUP,"<18" = 1,"18-24" = 2, "25-44" = 3, "45-64" = 4, "65+" = 5, .default = -1)) %>%
mutate(MONTH = month(OCCUR_DATE))
filteredCSV <- filter(formattedCSV, V_AGE_GROUP > 0)
filteredCSV <- filter(filteredCSV, P_AGE_GROUP > 0)
filteredCSV <- filter(filteredCSV, PERP_SEX %in% c("M", "F"))
filteredCSV <- filter(filteredCSV, VIC_SEX %in% c("M", "F"))
filteredCSV["Perp_vs_Vic"] <- case_when(
filteredCSV["P_AGE_GROUP"] < filteredCSV["V_AGE_GROUP"] ~ "LESS",
filteredCSV["P_AGE_GROUP"] > filteredCSV["V_AGE_GROUP"] ~ "GREATER",
filteredCSV["P_AGE_GROUP"] %% filteredCSV["V_AGE_GROUP"] == 0 ~ "SAME",
)
filteredCSV["PerpSex_vs_VicSex"] <- case_when(
filteredCSV["PERP_SEX"]  == "M" & filteredCSV["VIC_SEX"] == "M" ~ "M->M",
filteredCSV["PERP_SEX"] == "M" & filteredCSV["VIC_SEX"] == "F" ~ "M->F",
filteredCSV["PERP_SEX"] == "F" & filteredCSV["VIC_SEX"] == "F" ~ "F->F",
filteredCSV["PERP_SEX"] == "F" & filteredCSV["VIC_SEX"] == "M" ~ "F->M",
)
summary(filteredCSV)
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim Sex", ylab("Count"), xlab("Month"))
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim Sex")
ylab("Count") + xlab("Month")
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim Sex")
ylab("Count") + xlab("Month")
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim Sex") +
ylab("Count") + xlab("Month")
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim demographic", fill = "Perp->Vitim") +
ylab("Count") + xlab("Month") + legen
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim demographic") +
ylab("Count") + xlab("Month") + legen
countPerMonth <- filteredCSV %>% count(MONTH, PerpSex_vs_VicSex)
model <- glm(n ~ PerpSex_vs_VicSex / MONTH, data = countPerMonth)
countPerMonth <- countPerMonth %>% mutate(prediction = predict(model))
countPerMonth %>% ggplot() +
geom_line(aes(x=MONTH, y=n, color = PerpSex_vs_VicSex)) +
geom_line(aes(x=MONTH, y=prediction, color = PerpSex_vs_VicSex)) +
labs(title = "NY Shootings based on Shooter/Victim demographic", fill = "Perp->Vitim") +
ylab("Count") + xlab("Month")
ggplot() +
geom_histogram(data = filteredCSV, mapping = aes(x=PerpSex_vs_VicSex), stat="count") +
labs(title = "NY Shootings based on Shooter/Victim demographic", fill = "Perp->Vitim") +
ylab("Count") + xlab("Month")
ggplot(data = filteredCSV, mapping = aes(x=Perp_vs_Vic)) +
facet_wrap(~PerpSex_vs_VicSex, scales = 'free_y')+
geom_histogram(stat="count")
ggplot(data = filteredCSV, mapping = aes(x=Perp_vs_Vic)) +
facet_wrap(~PerpSex_vs_VicSex, scales = 'free_y') +
geom_histogram(stat="count") +
labs(title = "Distribution of NY Shootings Across Age groups") +
ylab("Count") + xlab("Shooter -> Victim Age group comparison")
ggplot() +
geom_histogram(data = filteredCSV, mapping = aes(x=PerpSex_vs_VicSex), stat="count") +
labs(title = "Count of NY Shootings based on Shooter/Victim demographic", fill = "Perp->Vitim") +
ylab("Count") + xlab("Month")
ggplot() +
geom_histogram(data = filteredCSV, mapping = aes(x=PerpSex_vs_VicSex), stat="count") +
labs(title = "Count of NY Shootings based on Shooter/Victim demographic", fill = "Perp::Vitim") +
ylab("Count") + xlab("Month")
ggplot() +
geom_histogram(data = filteredCSV, mapping = aes(x=PerpSex_vs_VicSex), stat="count") +
labs(title = "Count of NY Shootings based on Shooter/Victim demographic") +
ylab("Count") + xlab("Month")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
usCases <- read_csv(urlVec[1], show_col_types = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
baseURI <- "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/"
lookupURL <- "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/UID_ISO_FIPS_LookUp_Table.csv"
csvFiles <- c(
"time_series_covid19_confirmed_US.csv",
"time_series_covid19_deaths_US.csv",
"time_series_covid19_confirmed_global.csv",
"time_series_covid19_deaths_global.csv"
)
urlVec <- str_c(baseURI, csvFiles)
usCases <- read_csv(urlVec[1], show_col_types = FALSE)
usDeaths <- read_csv(urlVec[2], show_col_types = FALSE)
globalCases <- read_csv(urlVec[3], show_col_types = FALSE)
globalDeaths <- read_csv(urlVec[4], show_col_types = FALSE)
uidLookup <- read_csv(lookupURL, show_col_types = FALSE)
summary(globalCases)
usCases <- read_csv(urlVec[1], show_col_types = FALSE)
usDeaths <- read_csv(urlVec[2], show_col_types = FALSE)
globalCases <- read_csv(urlVec[3], show_col_types = FALSE)
globalDeaths <- read_csv(urlVec[4], show_col_types = FALSE)
uidLookup <- read_csv(lookupURL, show_col_types = FALSE)
globalCases
